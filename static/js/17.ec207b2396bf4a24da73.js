(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"3OZS":function(t,e,l){},GdO6:function(t,e,a){"use strict";a.r(e);var l=a("JrP0"),o=function(t){return l.a.post("/contacts/list",t).then(function(t){return t.data})},n=function(){return l.a.post("/contacts/all").then(function(t){return t.data})},i=a("Ueoi"),r={name:"Export",data:function(){return{filenameDefault:"xlsx-"+i.a.format(new Date,"yyyy.MM.dd hh:mm"),exportOpts:{filename:"",tHeader:["NAME","ID CARD","CITY","ZIP","TEL","MOBILE","FAX","EMAIL","QQ","COMPANY"],exportProps:["name","card","city","postcode","tel","mobile","fax","email","qq","company"],cellAutoWidth:!1,type:"xlsx",exporting:!1},list:null,loading:!1,pages:{page:1,size:10,total:0}}},created:function(){this.getContacts()},methods:{handlePageChange:function(t){this.pages.page=t,this.getContacts()},handleSizeChange:function(t){this.pages.size=t,this.getContacts()},getContacts:function(){var e=this;this.loading=!0,o(this.pages).then(function(t){e.loading=!1,e.pages=t.pages,e.list=t.list})},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})},handleExport:function(t){var e=this;this.exportOpts.exporting=!0;var l=this.formatJson(this.exportOpts.exportProps,t);setTimeout(function(){Promise.all([a.e(0),a.e(1),a.e(9)]).then(a.bind(null,"O/mB")).then(function(t){t.handleExport({header:e.exportOpts.tHeader,data:l,filename:e.exportOpts.filename||e.filenameDefault,autoWidth:e.exportOpts.cellAutoWidth,type:e.exportOpts.type}),e.exportOpts.exporting=!1})},500)},handleExportAll:function(){var e=this;this.exportOpts.exporting=!0,n().then(function(t){e.handleExport(t)})}}},p=(a("dyIJ"),a("KHd+")),s=Object(p.a)(r,function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"va-body-container"},[l("el-form",{attrs:{model:e.exportOpts,inline:"",size:"medium"}},[l("el-form-item",{attrs:{label:e.$t("excelExport.filename")}},[l("el-input",{attrs:{placeholder:e.filenameDefault,"prefix-icon":"el-icon-document",clearable:""},model:{value:e.exportOpts.filename,callback:function(t){e.$set(e.exportOpts,"filename",t)},expression:"exportOpts.filename"}})],1),e._v(" "),l("el-form-item",{attrs:{label:e.$t("excelExport.fileType")}},[l("el-select",{staticStyle:{width:"100px"},attrs:{value:""},model:{value:e.exportOpts.type,callback:function(t){e.$set(e.exportOpts,"type",t)},expression:"exportOpts.type"}},[l("el-option",{attrs:{label:"xlsx",value:"xlsx"}}),e._v(" "),l("el-option",{attrs:{label:"cvx",value:"cvx"}}),e._v(" "),l("el-option",{attrs:{label:"txt",value:"txt"}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:e.$t("excelExport.autoWidth")}},[l("el-switch",{model:{value:e.exportOpts.cellAutoWidth,callback:function(t){e.$set(e.exportOpts,"cellAutoWidth",t)},expression:"exportOpts.cellAutoWidth"}})],1),e._v(" "),l("el-form-item",{attrs:{label:e.$t("excelExport.execute")}},[l("el-button-group",{staticStyle:{"vertical-align":"top"}},[l("el-button",{attrs:{disabled:e.exportOpts.exporting,type:"primary"},on:{click:function(t){e.handleExport(e.list)}}},[e._v("\n          "+e._s(e.$t("excelExport.currentPage"))+"\n        ")]),e._v(" "),l("el-button",{attrs:{disabled:e.exportOpts.exporting,type:"primary"},on:{click:e.handleExportAll}},[e._v("\n          "+e._s(e.$t("excelExport.allPages"))+"\n        ")])],1),e._v(" "),l("i",{directives:[{name:"show",rawName:"v-show",value:e.exportOpts.exporting,expression:"exportOpts.exporting"}],staticClass:"el-icon-loading export-handler-loading"})],1)],1),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.list,"tooltip-effect":"light"}},[l("el-table-column",{attrs:{prop:"name",label:"name",width:"120","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"card",label:"ID Card","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"city",label:"city",width:"70","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"postcode",label:"zip",width:"70"}}),e._v(" "),l("el-table-column",{attrs:{prop:"tel",label:"tel",width:"110"}}),e._v(" "),l("el-table-column",{attrs:{prop:"mobile",label:"mobile",width:"105"}}),e._v(" "),l("el-table-column",{attrs:{prop:"fax",label:"fax",width:"110"}}),e._v(" "),l("el-table-column",{attrs:{prop:"email",label:"email","show-overflow-tooltip":""}}),e._v(" "),l("el-table-column",{attrs:{prop:"qq",label:"QQ",width:"110"}}),e._v(" "),l("el-table-column",{attrs:{prop:"company",label:"company","show-overflow-tooltip":""}})],1),e._v(" "),e.list&&0<e.list.length?l("el-pagination",{staticClass:"excel-pagination",attrs:{"page-sizes":[10,30,50],"current-page":e.pages.page,"page-size":e.pages.size,total:e.pages.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}}):e._e()],1)},[],!1,null,"20d98cee",null);s.options.__file="Export.vue";e.default=s.exports},dyIJ:function(t,e,l){"use strict";var a=l("3OZS");l.n(a).a}}]);